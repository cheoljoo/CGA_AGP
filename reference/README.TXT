#/*!		@page  		README.TXT
# *
# *     Copyright (c) 2006~ by Upresto Inc, Korea
# *     All rights reserved.
# * 
# * 	$Id: README.TXT,v 1.47 2006/08/28 01:19:47 cjlee Exp $
# * 
# *     @Author      $Author: cjlee $
# *     @version     $Revision: 1.47 $
# *     @date        $Date: 2006/08/28 01:19:47 $
# *     @todo         оñ ٶϴ. 
# *
# *     @section     Intro(Ұ)
# *      - ⺻  ⿡ ξϴ.
# *
# *     @section     Requirement Tool
# *      @li perl 
# *      @li doxygen 
# *
# **/

#/*! @page			README.TXT
# *     $Log: README.TXT,v $
# *     Revision 1.47  2006/08/28 01:19:47  cjlee
# *     no message
# *
# *     Revision 1.46  2006/08/23 01:32:56  cjlee
# *     *.stc IFEQUAL  multi-line ó Ϸ
# *     #{    ...   }#  multi-line ó
# *      Ѷ IFEQUAL(A,B)  ...    ׳ ϸ 
# *     multi-line϶  #{ .. }# ϸ.  flow.stcȿ  ߰Ͽ.
# *
# *     Revision 1.45  2006/08/22 09:17:24  cjlee
# *     <TAG_FLOW_START:PAGE> action  multi line ó Ϸ
# *     % .. %   # .. # ϶ # #  ó
# *     ϶ #{         }#   ˸
# *
# *     Revision 1.44  2006/08/22 05:34:26  cjlee
# *     2. stg multi óҼ ְ  stg  쿡 ̰͵  óҼ ִ stgl  ؾ   δ. (Է file stgl  쿡 List ؼϿ óϵ structg.pl  ϸ   δ.) - precompileñ ߰ ϴ    δ.
# *     Ѱ ִ   ̶ ȴ. FileName .h   Ǵ ̰, stgȿ ִ FileName  ǰ  ̴.
# *     test.stg , flow.stg ִٰ ϸ __ FileName  , STC_FileName  ġ ,
# *     *.stg  ͵ FileName.h -> $outputdir/FileName.stg .     ó Ѵ.
# *
# *     Revision 1.43  2006/08/22 01:28:31  cjlee
# *     1. precomile ؾϴ ͵鿡  Ȯڴ .pstg  ϴ    δ. ̰ ϸ Ȯڰ .stg  ϸ   δ.
# *     	pstg.pl 
# *     	pstg file : test.stg -> test.pstg  , aqua.stg -> aqua.pstg
# *     	Makefile flow , aqua , test   ߰
# *
# *     Revision 1.42  2006/08/21 11:12:32  cjlee
# *     precompile : STG_COMMON  alternative Ѱ    ذ (STG_BASIC )
# *     aqua.stg
# *     structg_precompile1.pl
# *
# *     Revision 1.41  2006/08/21 04:47:23  cjlee
# *     for PAGE TEST
# *
# *     Revision 1.40  2006/08/21 01:29:25  cjlee
# *     $save_typedef member check table_log ϶ ٸ type϶ die
# *
# *     Revision 1.39  2006/08/18 10:29:34  cjlee
# *     stc.upr  .stc ϸ OUTPUTؿ ڵ ϰ ϴ  ߰
# *        LOG_member_Get_func.stc  ߰
# *     flow.stc : state_go , print_state Լ ߰, flow.c  structure  member  Ҽ ִ c++ member getԼ 
# *     flow.stg : state鿡  define ڵ  
# *     structg.pl :
# *      - stc.upr  ó ߰
# *      - ITERATEȿ Set : A { B } = "C" ߰
# *      - stc.upr ͵ OUTPUTƷ ٷ ǰ 
# *      - stc.upr  Makefile ߰ϰ 
# *      - Set Hash 1  .... ( )
# *      - ó   : Makefile  STCó --> STC ó Makefile  
# *      - %save_typedef_member  , %save_typedef_name ߰  : LOG_member_Get_func.stc 
# *
# *     Revision 1.38  2006/08/16 05:46:07  cjlee
# *     IFEQUAL ߰
# *     Flow ׸ ߰ : flow.stg , flow_dot.stc
# *
# *     Revision 1.37  2006/08/16 01:22:46  cjlee
# *     FLOW dot߰
# *
# *     Revision 1.36  2006/08/09 05:33:48  cjlee
# *     no message
# *
# *     Revision 1.35  2006/08/04 12:01:55  cjlee
# *     no message
# *
# *     Revision 1.34  2006/08/03 08:12:32  cjlee
# *     no message
# *
# *     Revision 1.33  2006/08/01 05:51:01  cjlee
# *     no message
# *
# *     Revision 1.32  2006/07/28 04:42:25  cjlee
# *     no message
# *
# *     Revision 1.31  2006/07/27 11:44:10  cjlee
# *     #FIRST# / #LAST#  : ó    ,  setǾ    ִ RULE
# *
# *     Revision 1.30  2006/07/27 10:58:32  cjlee
# *     STG_COMMON   (  ϼ : README.TXT)
# *     LOG_TEXT_PARSING ϴ 
# *
# *     Revision 1.29  2006/07/27 01:58:29  cjlee
# *     <TAG_DEFINE_START: ....>  <TAG_DEFINE_END:...> ó Ϸ
# *     ǰ: ̷ HTML
# *         <TAG_DEFINE:.....>  </TAG_DEFINE>
# *
# *     Revision 1.28  2006/07/26 03:27:32  cjlee
# *     <TAG_DEFINE_START:AAA>
# *     #define ....
# *     .... (ڸ)
# *     <TAG_DEFINE_END:AAA>
# *      ϰ
# *     U32 <AAA>TTT;   ̷  ϸ ּ ڵ ٴ´.
# *
# *     Revision 1.27  2006/07/26 02:20:43  cjlee
# *     #define typedef ̵ ̵  ó 
# *
# *     Revision 1.26  2006/07/25 02:26:45  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.25  2006/06/14 06:41:27  cjlee
# *     no message
# *
# *     Revision 1.24  2006/06/13 07:35:08  cjlee
# *        : STAT ó 
# *     	table  %s .
# *     	accumulate , once  : STAT_ALL ߰
# *     	- pc.upr
# *     		table %s STAT϶ _%s .
# *     	-  structg.pl
# *     		STAT ó ߰ : Once , Accumulate 
# *     		_%s ó  : table
# *     	- userfile.stg
# *     		STAT   : ACCU.. .INC Ÿ table  밡
# *     		ü   ȿ pthis 밡
# *
# *     Revision 1.23  2006/06/10 07:20:06  cjlee
# *     2006.06.10 protocol ڵȭ ο  ǰ
# *
# *     Revision 1.22  2006/06/09 07:56:01  cjlee
# *     no message
# *
# *     Revision 1.21  2006/06/09 03:31:15  cjlee
# *     		STG_STAT_TABLE ߰
# *     		STAT  Set_Stat_Once.c   ߰ .
# *     		STG_ACCUMULATE , STG_INC߰
# *
# *     Revision 1.20  2006/06/08 00:35:08  cjlee
# *     no message
# *
# *     Revision 1.19  2006/06/02 08:46:38  cjlee
# *     no message
# *
# *     Revision 1.18  2006/06/02 08:40:37  cjlee
# *     no message
# *
# *     Revision 1.17  2006/06/01 05:41:27  cjlee
# *     no message
# *
# *     Revision 1.16  2006/05/30 08:43:06  cjlee
# *     no message
# *
# *     Revision 1.15  2006/05/30 08:10:31  cjlee
# *     no message
# *
# *     Revision 1.14  2006/05/29 11:45:04  cjlee
# *     no message
# *
# *     Revision 1.13  2006/05/29 06:13:24  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.12  2006/05/29 05:06:32  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.11  2006/05/26 04:49:46  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.10  2006/05/26 01:13:42  cjlee
# *     no message
# *
# *     Revision 1.9  2006/05/25 07:55:05  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.8  2006/05/17 08:22:42  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.7  2006/05/16 08:38:52  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.6  2006/04/19 07:21:47  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.5  2006/03/11 06:16:22  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.4  2006/04/03 03:34:09  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.3  2006/03/31 01:47:38  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.2  2006/03/31 01:45:28  cjlee
# *     *** empty log message ***
# *
# *     Revision 1.1  2006/03/31 00:59:14  cjlee
# *     *** empty log message ***
# *
# *     */


./structg/structg  ϴ 2 . ֳĸ 򸮱 ̴.

./structg ؿ   
cvs import -m "INIT" structg upresto start
 Ͽ project .

cvs co structg  ϸ     ̴.

binary  : cvs add -kb test.gif    (binary commit)

cvs add Makefile
cvs ci -m "INIT" Makefile

./hash.stg                                                          1.1 - Binary
cvs add -kb hash.stg
cvs ci -m "INIT" hash.stg 


/home/cjlee/structg
 make clean , make ϸ Ǵ ͵ Դϴ.

 
NTAF  : *.c *h
NTAM  : flat*.h
Դϴ.  (nested    Դϴ. ) 

/*****************************
* Fri Mar 31 09:22:11 KST 2006
2006.03.31

  : make ; make doc 
  : make clean

File 
flat ̶ nestedǾ structure   ̴. ( : Database nested structure  Ѵٰ )
- HISTORY.TXT
-Makefile
-README.TXT 
-code_gen.pl 		: perl ȭ : file *.c *.h (hash.stg $FileName )
-define_stg.h		: stg(structg) ϴ ⺻ ͵ Ƶ .
-flat_hdr_gen.pl	: perl ȭ : (hash.stg $FlatFileName ) *.h  
-structg.cfg		: Doxygen ̿ configuration file 
					: INPUT   .  ϰ recursive ǰ setǾִ.
					: Ȯڰ ٸ  óϷ FILTER ġ  ̴.
-hash.stg 			:  Nested ϴ  perl input ̴. 
					: 츮  κ  Ѵ.
-flat.upr			: flat file 鶧 ʿ  flat file    ̴.(DB) 
-header.upr			: file header ϱ  generic form
-footer.upr			: file footer ϱ  generic form
-function.upr		: file ǵ function  ּ generic form


/*****************************
* Sat Apr  1 22:27:49 KST 2006
2006.04.01

  ؾ ϴ  ؾ  ̴.
-         structg    ̰
n         perl  doc perldoc  , ̰Ϳ   ۼؾ Ѵ.
u       perldoc perl
u       perldoc perlre
u       perldoc Net::FTP
n         , ׻, use strict; Ͻʽÿ. α׷ Ŀ װ ϴ. ׷ use strict; ϸ ׸  ãƳ  ְ,   ϴ. 
u       perldoc strict   ϸ help  װ  ϸ   δ. ()
-         Ethereal SRCм
-         configuration ؼ ó ؾ Ѵ.
-         hash / timer / sequence 
-         TESTԼ ߰ؾ Ѵ.
-         Debugging  Լ  
-         ü  ׸, ׿  primitives   Ŀ ǵ κ   Ȱ  踦 Ͽ Ѵ. (Software 谡 ʿ)

ü  (Ѱ Ѱ )
- NTAF    óϴ  .
- Process ,  process ٸ  ߵɼ ־ Ѵ.
- ⺻ library  ϸ ,  library ؼ primitives  Ǹ Ͽ ؾ Ѵ.
	+ TEST library (code generator  ɼ ִ.)
	+ debugging / timer / hash or AVL / shared memory / sequence / conf file / м / text parser
- code generator  Ȱϴ  .
	+ structg(typdef struct ؼ ڵ ڵ )   tool   Ѵ.  ϴ      Ҽ ְ   ǥ Ǿ Ѵ.
-  protocol ߰Ǿ  κ conf GUI  ٲپָ ٲ δ ó ǰ Ͽ Ѵ. 
	+ δ PPP protocol stack 2 ´ٰ Ͽ,   
		== ppp ΰԽ 鶧, name argv   ϰ ־ Ѵ. ׷  ppp ڿ ־ ̸  Ҽ ֱ ̴. 
	+  protocol  ó  ִ. 
	+  module in / out ؼ  Ǹ Ͽ ϴ  (in/out ٸ type  찡 ߻ϴ ̸ ڷӰ Ϸ  ؾ ϴ?)


/*****************************
* Mon Apr  3 09:52:40 KST 2006
2006.04.03
 ϰ ؾ 
- ü frame work : perl ּ ޱ , Ϲ hash , timer 
	+ conf  text parser ٸ  ̰ ϸ   .

 
-  : perl ּ ޱ , Ϲ hash (stg_code_gen [structg] ̿)
perl ּ enginsite perl editor  


/*****************************
* Tue Apr 11 14:35:57 KST 2006
2006.04.11
* [ö] Code Generator (structg) v1.0.doc ۼ Ϸ 
* 
-	  غƾ Ѵ.
-	hash structg ؼ     غƾѴ.
-	ּ ٴ Ϳ ؼ 캸ƾ Ѵ.
-	ProC ٸ ؾ ϴ ϴ ڵ ڵ  ؼ غƾѴ.
-	Լ Ģ  ؾ .
-	make install   Ѵ.


2006.04.19
Ģ : OUTPUTδ Ѱ .h Ѱ .a .  (flat_?.h  pc ؼ  )

======================================================================================
====   Section   Two  (2)
======================================================================================
 ؾ ϴ  Corelation ڵȭ   
corelation  ϸ  key   ؼ  ϸ
ڵ code ǰ Ҽִ  ǰ   ̴. 

⺻   
CreateTime , IMSI , TMSI , IP  ־, ̰Ϳ ؼ ־δ   Key  ؾ ϰ , 
 KEY ؼ  ߿ ɼ ִ  Ǿ  ̴. 
KEY ̸ fix   ؾ  ̴.
 ڿ   structure   ̰, 
  ͵   صξ ϴµ ,    ̰,
   ؼ   ö ,  ó ؼ DURATION  ؼ  ִ  
  ؾ  ̴. 

stKEY
ϴ , stAAA , stBBB , stCCC 3 ͵ ִٰ .  key Time/IMSI  Ǹ .
 ȿ  ͵  ִ structure    ̸


  Ϳ ؼ  Code  ٸ Code ش.

KEY typedef struct _stTimeIMSI {
	int	type;
	IMSI
	iCallTime
	iCallMTime
} stTimeIMSI;

HASH typedef struct _stExample {
	HKEY  stTimeIMSI	sKEY;
	/*   ؼ Table Ѵ. */
	HDATA stAAA sAAA;
	HDATA stBBB sBBB;
	HDATA stCCC sCCC;
	stComplex sDDD;
} stExample;
- HASH ؼ Ϲ Ҽ ְ ̹ ǰ Ǿִ. ̰ ؼ Ưȭ ų ʿ ٰ .
  HASH  , ƴϴ..  KEY hash init Ҽ ְ ְ initȿ ̰͵ ־ִ ͵ ڵ    δ.
ڵ忡  ͵  ξ  ̴. 
- Threshold ߰ϴ    ؾ  ̴.   
	踦  ̳ ׷   , threshold ϴ  Ѵ. 
	 ȿ threshold ϴ   ־δ    δ. 
	 ϴ δ ̶ +-  ξ ǥϴ    ̶ Ѵ.



/*  stExample ͵   ͵θ  ־ Ѵ. 
** ׷ , ǵǾ    ̷ ó Ҽ ִ.  
*/
NEWTABLE typedef struct _stComplex {
	DURATION ATime(sAAA.CreateTime,sBBB.CreateTime) - [threshold ǥϴ  ]  ;
	DURATION BTime(sBBB.CreateTime,sCCC.CreateTime);
	AVERAGE  CPktCntSec(sAAA.PKTCnt,ATime);
	AVERAGE  CPktSizeSec(sAAA.pktsize,sBBB.pktcnt);
} stComplex;

  . ̰ ȿ   ִ , ̰ θ Ѵٰ Ҽ ִ° ־  ̴.
ǥ  ؾ   δ. 

̸ ::::
STG_HASH_KEY
STG_COMBINATION_TABLE 


======================================================================================
====   Section    3 : NTAM   Ǿ ϸ, ̰ ؼ  ͵ غҼ ִ?
======================================================================================
NTAM ȣ  ޽  ̰, ϴ   ޽ type  ش ó ؾ Ѵ.
TLV̵ TV̵ ؼ ϴ  ϰ,  msg type  ش strucuture  Ŀ  ó ϰ ȴ.
⺻ Ʒ ؿ ִ STG_HASH , STG_KEY ⺻ Ѱ ̻ ǵǾ NTAM Code   ̴. (NTAM  Ѱ̻   ʿϱ ̴.) 

1. ȣ ó  ( ų  Ϳ  ó ϰų   ʴ´.)
ȣ ޽ Ǵ LOG ޽   ޴´.  Ŀ type   HASH   Ѵ.
HASH  IP -> IMSI , IMSI -> TMSI , TMSI -> Time ã´.
main : hash_init() ؾ  ̰
hash_init :  3 hash  ó ؾ  ̴.  (̸ ȭ  ʿ䰡  ̴. ַ typedef ̸  prefix ߰)
	ó κп msg ϱ  msg_type   ־  ̴. ƴϸ  ߿ msg_type ־ . 
#define IMSI_STR_MAX 		16
	[[ U32	msg_type; ]]
STG_HASH_UNIT  typedef struct _stIP_IMSI {
	STG_HASH_KEY	U32	IP;
	STG_HASH_DATA	U8	IMSI[IMSI_STR_MAX];
} stIP_IMSI;
̷ Ͽ ȣ ; Ѵ. ̷ ͵鿡  HASH ϰ  ̸, 
HASH DATA κп  TIME / IMSI / TMSI / IP / timerid   ־ִ  ־  ̴.
STG_HASH_DATA  Ǹ ؾ   δ.  (1 ־߰)!

ȣ  key data  ǿ  ̴.  ִ type  ̷ ó ؾϴµ , ̰   δ. 
KEY ǵ κа DATA ǵ κ  ־  ̴. 

 :  2  óϴ  Ѵ. 


2. ȣ ϷǸ LOG  msg鿡 ؼ key(TIME / TMSI / IMSI / IP) ޾ִ  ؾ Ѵ. 
 : ⺻ call ȣ  ͵鵵 ̷  ߴٰ ʿ  ° ǹ̰ ִ...
call µ ̷    ؾ ...     ϴ  ??
   ȣ߿  ޾ƾ  ؾ ϸ, ̷  STG_HASH_MAIN_UNIT ؾ ϴ  ƴѰ Ѵ.
STG_HASH_MAIN_UNIT ϴ Ϳ char *Protocol[MAX]    type definition value []  ϰ Ͽ ϸ   δ. 
 ͵  𸣱 ̴. define ϰ ߰   ͵   ΰ? 
(޸ 񶧹 ߻ϴ  ϴ  ϰ ̷ κ ϴ ͵ Ѱ ̶ ȴ.)
- ϴ 뿡 ؼ  ʴ     δ. MAX  ϰ Ͽ  ̴. MAXŭ  ϱ ̴.  
- char cnt[] ־  ݺ Դ  ǥ ϸ   δ. 

STG_HASH_MAIN_UNIT typedef struct  _stKEY {  /// ̰Ϳ  ã Key   ΰ? ó 2 Key  ΰ? 
	TIME
	TMSI
} stKEY; 

STG_DATA typedef struct  _stDATA {  /// ̰Ϳ  ã Key   ΰ? ó 2 Key  ΰ? 
	IMSI
	IP
	stPPP *PPP; 			/* stPPP   ⿡ ޾ְ Ѵ. */ ̹ ޷ִ null Ȯϸ ȴ.
							///  ް ϰ  array ϸ   δ.  
							/// ش session  ´. timeout ǰų,  ų. 
	*GN
	*IUPS
	*WAP
	stComplex	AA;
} stDATA;
  Serviceõ  ִ.


  κ : key  - Ϸķ   dependancy    , ׷   ߻ 쿡  ó ???
LOG  key  ְ   Key ִ checkϿ óϴ  θ   δ. ()
̷  2 ִٰ  غ. ( ִ°?)   TIME / TMSI / IMSI or MIN / IP  쿡 IMSI MIN ϴ    ־  ̰ ,
MIN or IMSI  ó ޶  ̴. 
union ̿Ҽ  ذ  ΰ? union ̿ϵ type ־ִ  ־ ٵ, type  unionó ϴ°  ΰ?
( IMSI  MIN ׳ ȣ óϸ ǹǷ   ȵȴ.   ٸ type   ɼ ִٴ ̴.)


== 2006.05.17 == 
STG_HASH_KEY_Combination typedef struct _stKEy {
	TIME		// ű structure̾  ؾ  ̴.  
	TMSI
	IMSI
	IP
} stKey; ؼ  ̴. ̰ 켭  2 main Ǿ   LOG ù°  صξϸ, ( ͸ Ѵ. !!!!!!)
  ٸ system  ̰͵ ٸ Ͽ ο process  ϰ   ̴. 
 ֵ鿡 ؼ HASH ִ ̴. 
STG_HASH_DATA ϴ κп ó STG_DATAó   { char cnt[]; char *log[]; } Ͽ ϰ  ̴. (log alloc Ͽ  ޾ش.)
߰   ؾ ϴ ؼ  ... ( ص Ǵ κ̶ Ѵ.)

ڵ  ; ϴ ͵ :
- 2 hash   (hash init ڵ) - hash_init  +HASH_INIT+
- 2 stuructureڵ  
-strucuture GRP  TYPE 
	2 ¥ structure (ȣ)  (1 + ?)
	LOG structure 			(2 + ?) - Nested ó key structure ؾ Ѵ.  
-size ڵ 
-type  ó (key , data ؼ )  - switchó κ  (ȣ ó    LOG  شɶ NewTable  processing)
	hash_add , timer ó 


perl α׷ ۼ :  .h о ʿ  %hash  д. Ŀ    program ϴ    δ.
flat PC  ; InsertDB(AAA *a)  ϰ Լ ȿ flat_AAA *b; b = (flat_AAA *) a; ؼ ϰ  ̴. flat ⼭ ϴ  ̴. (flat...h include) 

Memory   : α׷  .... ޸𸮴  ߿   ¥  ðܵ.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

3. LOG msg ߽ óϴ ܰ
 NEWTABLE̶ ǵǴ κе鿡  ó Ҽ ֵ 
ڵ尡 ڵ ߰ Ǿ Ѵ.  NEWTABLE  AA  ó Ҽ ֵ ߰Ǿ  ̴.


ڵ   ΰ? 
main(){
	hashinit();
	process();
}
process(){
	switch(msg-type){
		TYPE_DEFINE:
			type_process();
			break;
	}
}
type_process(){
	hash 
	or
	STG_DATA Ŀ  3 ó
	or 
	DB ٷ  (̶ flat.. ) 
}

test.sh   ڵ Ҽ ְ ־.


/*****************************
* 2006.05.25 -  Section 3  Ϸ 
======================================================================================
<< μ ڵȭ ó ؾ κп  Ʈ >>
======================================================================================

[ CO_LOG ]
1. Hasho, TimerN init κ ڵȭ
   - Hasho, TimerN   3 Ѵ.(Key: TMSI, IMSI, IP)
>>> OK

2. Corelation ޼ ޾ Command   ADD,DEL,ALL DEL ϱ ؼ
   ޼ ó Command ʵ尡 ;  .
   ( Corelation ޼  Corelation ʵ尡  ٸ )
>>> uiCommand   ȣó ߰ ˴ϴ. (  ) - NTAF ÷  ̺κ ־־մϴ.

3. Corelation ޼  ó  (uiCommand  : add , del , all_del)
   1)  Corelation ȣ ޼ Hasho, TimerN Add
      - ޼ ޾ Decoding Ѵ.
      - ޼ Hasho ̺ Ÿ  ° Ѵ.
        (Hasho ̺ Ÿ κп ֱ )
      - Hasho, TimerN ̺ Add Ѵ.
      -  Hasho ̺ ȭѴ.
        - ޼ Hasho Key شϴ Ÿ   Hasho ̺ 
          ˻Ͽ Ÿ Ѵ.
        -  Ÿ  Hasho ̺ UpdateѴ.
>>> Add ִ  쿡 , ִ κ ְ ο  Ѵ.
>>>  Ϳ DELETE or ALL DEL߿    ؾ  ̴. 
>>>   (  ݱ  DB  ó)

   2)  Corelation ȣ ޼ Hasho, TimerN Delete
      - ޼ ޾ Decoding Ѵ.
      - ޼ Hasho Key   Delete Ѵ.
        (⼭  Hasho ̺ Node ϴ° ƴ϶ TimerId UpdateѴ.) 
>>> stg file STG_HASH_DEL_TIMEOUT  
>>> delete_timeout̳  delete Ǿ ϴ 쿡  TMSI   Set_Combination_Once()  Ѵ.
   
   3)   Corelation ȣ ޼ Hasho, TimerN ALL Delete
      - ޼ ޾ Decoding Ѵ.
      - ޼ Hasho ̺ Ÿ  ° Ѵ.
        (Hasho ̺ Ÿ κп ֱ )
      - ޼ Hasho Key  Hasho Ÿ(Corelation ) ´.
      - Ÿ ִ   Hasho ̺ Ѵ.
        (⼭  Hasho ̺ Node ϴ° ƴ϶ TimerId UpdateѴ.)
>>> stg file STG_HASH_DEL_TIMEOUT  
>>> delete_timeout̳  delete Ǿ ϴ 쿡  TMSI   Set_Combination_Once()  Ѵ

4. Log ޼  ó 
   1) Log ޼ Corelation  Decoding Ѵ.
   2) Log ޼ ִ Hasho ̺ Key   ش Hasho ̺ 
       Corelation  ´.
>>> ã  ??  
   3) LOG ޼ TMSI Hasho ̺ Ÿ ʵ忡 Ѵ. 
>>>  TMSI ƴҼ ְ STG_HASH_KEY ǵǴ  ó member ޸ ˴ϴ.
      (malloc ̿, Pointer Ѵ.)
   4) Log ޼ Corelation  Encoding Ѵ.
>>> accumulate  ó Ѵ. (ǵ Լ call ϰ )
   5)  Corelation  + Log ޼ Body  ޼ť .
>>>   Corelation ؼ ״ DB  msgQ .

5. Ÿ̸ӿ invokde  ȣǴ Լ  ڵȭ
   1) Hasho ̺ TMIS  
      - key شϴ Ÿ Log ޼ õ ʵ Ÿ free ش.
      - Combi_NewTable  ó
      - Key شϴ Node Ѵ.
   2) Hasho ̺ IMSI, IP  
      - Key شϴ Node Ѵ.

6. μ ó ۽  hasho ̺ Ÿ Ÿ̸Ӹ ޾ִ κп  
   ڵȭ

7.  structg   ü   α׷ .
   ϴ  μ  ϴ ׽Ʈ   ҽ 鼭 ڵȭ ó
    ° ؾ   .
>>>  սô!!!

   
[ M_LOG ]
1.      MID ߰ switch  MID óԼ ȣ⿡  ڵȭ
2. MID ߰ MID óԼ   ڵȭ
>>> OK ? ߰ؾ  κ ˴ϴ.
 

>>> ߰ : CREATE κп  Ȱ?
>>> ̰ ؼ NTAF ڵ DB Queryؾ ϴ  ̸  Ǹ Ͽ 
stg file  ݿѾ մϴ.

stg    
-typedef struct 
	typedef struct _st_IUPS_Sess_Cnt {     {  ٿ   ȵ
	typedef struct .. {  }  AAA ;    AAA 
		COMBI_   combinationϱ  prefix
        TIM_   DB Table ٷ  Structure prefix
        CFLOW     
-ּ (Ʒ 2 )
       /*  */ ּ 
       ///< ּ 
-Short Name
	%...%  DB  Short Name  key wordԴϴ. ּȿ    ﰡٶϴ.
	ex) MTIME       utime;  %MTM%   /**< micro  Ÿ ð */   
        utimeſ MTM . (DBÿ ) 
        %..%  ٸ ׳ ڽ ̸ ״ .
	$shortremoveprefix ǵ ̸    ..
		 "TTTTT__"  Ǹ ߽ϴ.
-#define     typedef struct  { };  ܺο   {} ȿ  ּ.. ó   ̴ϴ
-
       ó : Ϲ typedef struct  
       κ° : STG_COMBINATION_TABLE typedef struct 
       ° : STG_HASH_KEY typedef struct    (̰    ؾ մϴ.)

̷ ȵ˴ϴ.
- STG_HASH_KEY  ȵ structure  nestedǴ  ҷ   
- ׳  ٸ ̸    ؼ .. ( ɷº ׳ ׷ ذ)
- #if 0  ־  ׷  𸨴ϴ. ׳  óع. #if 0   ׳  ּ
 
 : structg   checkoutϿ userfile.stg Ͻø DBñ  ó Ǵ  Դϴ.
structg.pl Ͻ κ   test.sh  comformance test Ͻñ ٶϴ.


<< ߰ ؾ  list  >>
union  ó : TIM_ union  ϰ Ѿ Ѵ. (flat ׳ type  )
 Ǹ ־ ó ؾ Ѵ.    Ǿ  fixؾ Ѵ. 
 : 2  ؾ Ѵ. 
- Iub ؼ   ؾ ϴ ԰  ãƺƾ   ̴.

2006.05.28
<<  >>
- ü ּ ܴ. (ϸ ҽ ԵǵѴ.) 
	ҽ ȿ ǰ ִ Ϳ ؼ   ־  ̴. 
	ҽ  ٸ  ̿Ҽ ְ  ʿ. 
	perl package ʿ (pm : perl module)
- structg  ǵ Ѵ.
	ؾ ϴ 鿡 ؼ ϰ, ܱ   compiler   Ѵ.
	vi stg, stc  ó Ҽ ֵ editing ϰ ϴ  Ѵ. (vi or vim or ׹ editor)
	  Ģ doc ϴ  .  code ¥ ڵ  Ǵ   Ѵ.
	ex) /* */  ̰  ⼭   Ѵ.  /* ȿ  Ʋ ʰ ۼ ؾ  ̴. keyword    */


- PT ۼѴ. (ð  ɸ ..     ä ߿ ߸ ϴ°  )
	ü   
	߿ ٽ readable 
	dynamic static  -> , ӵ , 츮 dynamic  ʿ ,     
	ȿ  
- ETT tool 񱳸 Ѵ.
- Data Minining   ϰ   ؼ  Ѵ.
- ٸ   å ؾ Ѵ.     (  ,  ۼϰ : ȵǸ ׸)


- ְ   Ѻ. (  M_LOG ) 
- NTAF Ϻ ڵȭ  
	union ߿ óϴ  Ѵ.  ߿ NTAF protocol ߿ Ҽ  ̴.
-  ߰
	- multi stg stc .			* perl
	threshold 						* perl + stc 
	success , fail  뵵 ˷ּ. ( ϻ : ũ  .)  * new
	е Code  ó ü  (fault ߰) * new
	define    ش string ִ ó * perl + (perl prt stc )
	ڵ STAT ϴ   , 5  timer stc ϸ   δ. COMBI_STAT     մϴ. (reserved word)  *stc
		 ڷ  Ƶδ κ ʿϴ. thread  5и ϴ    δ. timer ߸ list  óϰ,
		  ͵ ο Ϳ ޾Ƶδ ̴. (hasho linkedlist ̿ϸ   Ҽ   Τ.) 
		list 鼭 ϴ° ? ƴϸ , ׳ Ѱä ó ϸ鼭 ϴ  ?  5 踦 óϰ Ǹ  ϸ鼭  ʿ䰡 ٰ δ.
		ֳĸ,  Ͽ   Ϻ ɼ ֱ⶧ 踦 ٴ   ִٰ .   (5и STAT DB   ϸ   δ. )
		߿ 5   Ҷ     ־ ϸ,    ϴ     ƾ  ̴.
	NTAM raw packet   ٽ loading۾   *stc
	   comination  ִ κ 	* perl : з
	structureȿ ð ִ κ (NTAF ص   . - ϴ ̰  ʱ ϴ    δ. ) * 
	GUI query Ȯϴ  غ!! 	* perl + stj
	- ߰ Query  ʶ "KTF ETL  缭" ϱ ٶ. 
	- ߰  ʿ 쿡 "CoSort ڷ" ϱ ٶ.


- Protocol ڵȭ
ϴ protocol鿡 ũ 2 . text binary  ̴.
ϴ binary ؼ ̾߱⸦ ϸ 3GPP , 3GPP2 ϴ  type Ѵ.
binary - ASN.1  Ͱ ,   M , TLV, TV , V   

Ϲ 츦 ѹ  . 3GPP   Msg ϸ ,  ȿ Information Elements(IE) ͵ ִ.
MSG  м  ʿ䰡 ,  м    Ǹ    Ȱ  ȭ Ѿ Ѵ.
Mendatory , Conditional , Optional   , mendatory    ȴ.
IE bit operation ߰Ǿ Ѵ.
REQ messageȿ   Ѵ.  member鸶  ִ    ǥ ؾ Ѵ. (-1 or 0   )
 msg ϴ  տ type ξ Ÿ־ Ѵ. 
߿  ū size  ϱ ؼ union ϸ ȴ. ( stgȿ union   .)
(union ó Ұ 󸶳  𸣹Ƿ linked list  ұ ϴµ   ᱹ TLV ٽ ݺϴ Ƿ ޶° ϳ   δ. static ƴ linked list   ǹ̰   δ. : union ϸ   ˼ .)
  : IE  ö    ؾ ϴ? recursion IE̳ msg ȣϴ 찡   ̴.
REQ MSG Ǹ . м Ͽ    ִ κ stg  ̴.  ȿ     ϴ  ϴ  ٸ  δ.  cnt ͵ ʿ غ.

Bit operation ó 
(endianõ  ٷ  ó ʿ)
SIP  Text ó  : TIDY
(lex yacc ؾ ϴ GNU source ؾϴ?  ؼ  Ͽ Ѵ.)

2006.06.09
- 5  ڵȭ
  ð  5 踦 Ѵ.  5и  STAT ó Ѵ.
ENDTIME  踦 ̸´ٰ ̾߱ , ڿ ޶   , 
  ϴ ߿ Ҽ ְ ϸ   δ.  װ pl stc     δ.

2006.06.10
- protocol  ڵȭ  м
RANAP   ̶   .    ѹ  غƾ   δ.
protocol   ,  binary ߿ GTP  , ׹ۿ UDP , TCP  RFC ⺻ Ǿ ͵̴.
GTP ؼ  м  ϱ ϰڴ.

-  GTP м
TEID IP ߽ м ϸ ,type binary̴.  
ó packet  UDP Ư Ʈ Ͽ   ̰.
  ޽ type   ޽ ˸,   IE  type , [length] , value  ˼ ִ. 
̷ ͵ table Ѱ  type , length , value ְϿ  ش    ̸, 
req , resp ޽ mendatory,optional ǥ ͵ ǥϿ    δ.
mandatory 쿡 ̰    ߻ϴ ڵ Ҽ    Ѵ.
STG_PROTOCOL_IE #type:0x01-len:..-value:..#  typedef struct _st_IE_TEID {
	U8 teid[MAX_TEID];
} IE_TEID;
STG_PROTOCOL_A typedef struct _st_GTPC_REQ {
	IE_TEID uiTEID; %M% 		/**< mandatory teid */
	IE_IP  	uiIP;   %O% 		/**< optional ip */
} PROT_GTPC_REQ;

- GMM м
GMM  mandatory 쿡 value ϴ 찡 ߻Ѵ.
̰츸 GTP ߰ ָ   ̸,  GMM ҽ   ־  ̴.
GMM  󸶳 Ϲϼ ִ ؼ  غƾ  ̴. (    δ. loop 2  ȴٰ ϴµ,  ݿ Ǵ  ƴ?  ̰ Ϸ  ݵ鿡 ؼ   ؾ ϴ?  protocol table ־ٸ   ϸ Ǵ Ϲ  ? )
idea   
FieldFormat  ʹ  ־ָ Ǹ,  ־ִ ͵ ش structure member  Ǿ Ѵ.
DetailField FieldFormat  ̸ ,  ٸ ó ϴ  GTPC ȰҼ ִ κ .
 ǰ : GMM01  κ    ,    Ű ϴ  Ÿ ǰ   .
	  ׳   , ƴϸ ٸ  typedef ȿ Ÿ ó ؾ ϴ ؼ ǰ    Դϴ.  ٸ  Ÿٴ  typedefȿ  ̸ ϸ ȣ §  ڵ  ε , ԵǴ ͵ ȭ Ǿ ôϸ Ź ھ  ؾ Ѵٴ  Դϴ.
	 req , resp structure Լ ̸   ä ϴ ͵ Ѱ ϼ  ̴. (VC++ programó)
 : ⼭ RAB ó  ؾ ϴ Ϳ ؼ ó ߰־   ...  RABlistִ   ó    Դϴ.
ǰ 2 : GMM   GTP ׳ ǰ Ҽ   .   ϸ      .
ǰ3 : IE Ǵ  ־  ̴. IE ϴ  ϰ , req  ޽ ϴ   Ǹ Ͽ  ̴. 3GPP , 3GPP2   IE MSG  Ͽ óϱ ̴. 
(binary TLV TV type  ó ϼ)

׾ȿ hash , timer ϴ   ־ ¥   δ.
WAP1.0 Ȱ    (2.0 http, 1.0 binary )


- TIDY  м ؾ  ̴.   parsing    ִ ˾ƾ   δ.

2006.06.13 ȭ
STAT ߸ § κ ִ. (ְκ) 
Accumulate Once STAT    ̴.

2006.06.14  : eosoft ڵȭ  
IuPS LOG, CF  ϸ
COMBINATOION , STAT   ͷ ϼ Ͽ Ѵ. (ȭ鿡  )
̰͵ Ҽ ִ   ϸ, ̰ʹ   Ǿ Ѵ.
(ð ؼ ִ   log ̴ Ϳ  ó : ϴٸ)
-  α׷ ƾ ־ .

[[2006.07.25 ]]
*TEXT Parsing ó 

*  
: prefix ٲپ fileڵ  (̰ ʿϸ  ־ ȴ.)
	-  GLOBAL  óϴ  鶧 ڵȭ ϱ Ѵ.
: prefixٿ ٸ library ְ , ش makefile ֱ
 - ϴ 뷫 ó , LOG_KUN REQ/RESP Ѱ ħ ( prefix  )
	- ΰ  ؼ  ߵ (stc.sh)

*  
: BREW , WIPI  ó ߰ (LOG Ϻθ  ,    ó ߰ : binary κ ó ߰)
ME,KUN : ΰ Ѱ  ó (  ϴٰ) 
RTSP(VOD) : text parser   
- online ϱ  application download
BREW download(TEXT) :  text parser 
WIPI download(TEXT) :  text parser 
-  : download  application ϸ ϴ 
BREW online (binary) : binary ¥ .
WIPI online (binary) : binary ¥ .
RTP , RTCP(Jitter)

BODY -> Call -> Page
binary parsing

[[2006.07.26]]  
#define ġ  ó Ǿ

<TAG_DEFINE_START:RespCode>
#define	RespCode_A_Type  1 /* */
#define	RespCode_B_Type  2
#define	RespCode_C_Type  3
<TAG_DEFINE_END:RespCode>
    U32		<RespCode>RespCode;	
    ̷  ó ϰ .

<TAG_DEFINE_START:AAA>
#define ....
.... (ڸ)
<TAG_DEFINE_END:AAA>
 ϰ 
U32 <TAG_DEFINE:AAA>TTT;   ̷  ϸ ּ ڵ ٴ´.

body ٷ κ ٷ ϳ. HREF  Menu ϴµ Ǿ
IMG SOUND ؼ ٷ   δ.
IMG , SOUND  ̰ arrary  δ°   ̴. (MAX θ   δ. 20 )
IMG, SOUND̵  PAGE    

1. MENU  : hashg Ѵ. size string Ѵ.    ִ  Ѵ.
	<a href...>()</a> () 븸 ϱ Ѵ.
2. IMG,SOUND(PAGE) : <img src=   ̾Ƴ.  
	 Path URL  Ѵ. ( http://  ټ  ̴.
	img  ڿ ״´. PAGE   ͵     Page   
	 PAGEȿ ־ ó ϰ , ٸ ̰ͺ ο PAGE ν Ѵ.


[[2006.07.27]]
STG_COMMON typedef struct _stg_call {
	##	;;   STG_COMMON_MEMBER{"STIME time"} =  %CreateTime% /**<  ⺻ ּ  : DEFAULT  ̰ ϰ  : ʱ Ÿ ð */ 
	STIME time;	 %CreateTime% /**<  ⺻ ּ  : DEFAULT  ̰ ϰ  : ʱ Ÿ ð */ 
		##	;;   STG_COMMON_MEMBER_LOG_KUN{"STIME time"} = %Time%  /**< ּ2 */ 	
		<TAG_COMMON_MEMBER:LOG_KUN>%Time%  /**< ּ2 */ 	
		##	;;   STG_COMMON_MEMBER_LOG_ME{"STIME time"} = %METime%  /**< ּ3 */ 	
		<TAG_COMMON_MEMBER:LOG_ME>%METime%  /**< ּ3 */ 
	MTIME		utime;  %MTime%	 	/**< micro  Ÿ ð */

<TAG_KEY>
	IP4 		uiIP;					%IPAddr%				/**< IP address */
	U8			ucTMSI[DEF_SIZE_TMSI];	%TMSI%					/**< TMSI */
	U8			ucIMSI[DEF_SIZE_IMSI];	%IMSI%					/**< IMSI */
</TAG_KEY>

	U32		uiBase; 			%BASE%  /**< BASEID */ 	#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>BASE_ID:{DIGIT}#
	U8		uiNID[EX_MAX_NID]; 	 %NID%  /**< NID */ 	#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>NID:{VALUE}#  
		<TAG_COMMON_MEMBER:LOG_KUN> /**< NID */  %NID%		#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>KUN_NID:{VALUE}#  
	U32		uiSID; 				
		<TAG_COMMON_MEMBER:LOG_ME>  /**< SID */  #PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>ME_SID:{DIGIT}#
		<TAG_COMMON_MEMBER:LOG_KUN>  /**< SID */  #PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>KUN_SID:{DIGIT}#
} LOG_CALL;

STG_LOG_TEXT_PARSING typedef struct _... {
	<STG_COMMON:LOG_CALL>
	U32		Test1;
} LOG_KUN;

STG_LOG_TEXT_PARSING typedef struct _... {
	<STG_COMMON:LOG_CALL>
	U32		Test2;
} LOG_ME;

̰ ȿ Ҷ <STG_CALL>
̰Ϳ 뷡 ó ־ ϴµ????
STG_CALL̶  Ѱ   ̴.

TAG_COMMON:KEY   KEY  HASH ξ Ѵ.
  DATA  LOG_CALL Ǿ ̴.
- signal  ظ  ΰ?  uiCommand  structure ڵ Ѱ ش. ش key  ϰ ϸ  ̴.
  LOG_CALLտ uiCommand  ߰ص    ̴.   command  
  ADD  ->  ȿ setǾ   IP setǾִٸ IPε hash    ݿϸ   δ. (FIRST, LAST ؾ ϴ ???)
  	COMMON_DATA FIRST,LAST Ģ  ߰ ִ ϸ  ̰, KEY  ԵǴ ̸  ãƼ setִ° ⺻ Ѵ.  
  DEL  ->  ȿ setǾ  IP , TMSI   ãƼ HASH DEL ָ ǰ
  ALL_DEL   ãƼ loop  ѹ    ִ  ⺻ Ѵ.

̰ ⺻ ؾ ϴ  2 ִ.
 κ -->  ⺻ <COMMON> structure {}  ־ϸ  KEY  // KEY+DATA
 κ --> ΰ  ϴ   // KEY + DATA + Timer/Combination ΰ  
 κ --> uiCommand ϴ  Ѱ  ߰ (signal  ) 
Լ -->  field 鼭 null ƴϸ set ְų(FIRST) , LAST ( NULL ƴϸ .)

 STG_HASH_KEYʹ    ΰ? ϴ  structure еǾ.
GLOBAL LOG   , COMBINATION , STAT   ִ.
STG STC   Ѱ Package ϸ   δ. 
(STC Primitives Ǹ ϸ Ѱ library ü   δ. makefile ߰)

 : STG_COMMON   ϸ 
<TAG_KEY>  ߿ KEY 
U32 uiBase; ڿ   ؿ ǵȰ  default
ؿ <TAG_COMMON_MEMBER:TT>   Ǹ TT structure  ǵ ǹ̷ Ǿ ǹ


  :
/* LOG ǵ  */
# BASIC_TYPEDEF #
typedef struct _stg_call {
	STIME time;	 /**<  ⺻ ּ  : DEFAULT  ̰ ϰ  : ʱ Ÿ ð */ 
	MTIME		utime;  	/**< micro  Ÿ ð */

	IP4 		uiIP;					%IPAddr%				/**< IP address */
	U8			ucTMSI[DEF_SIZE_TMSI];	%TMSI%					/**< TMSI */
	U8			ucIMSI[DEF_SIZE_IMSI];	%IMSI%					/**< IMSI */

	U32		uiBase; /**< BASEID */ 	
	U8		uiNID[EX_MAX_NID]; 	 /**< NID */  
	U32		uiSID; 				
} LOG_CALL;

#BASIC_SIGNAL #
typedef struct ... {
	U32	uiCommand;
	LOG_CALL aLOG_CALL;
} LOG_CALL_SIGNAL;

# BASIC_KEY #
typedef struct ...  {
	IP4 		uiIP;					%IPAddr%				/**< IP address */
} LOG_CALL_KEY_uiIP;

typedef struct ...  {
	U8			ucTMSI[DEF_SIZE_TMSI];	%TMSI%					/**< TMSI */
} LOG_CALL_KEY_ucTMSI;

typedef struct ...  {
	U8			ucIMSI[DEF_SIZE_IMSI];	%IMSI%					/**< IMSI */
} LOG_CALL_KEY_ucIMSI;

# BASIC_DATA #
typedef struct ... {
	LOG_CALL	aLOG_CALL;
	U64			TimerId;
	/* LOG ݺ */
	U16 		usCntLOG_CFLOW;
	U16 		usIsDoneLOG_CFLOW;
	LOG_CFLOW 	*pLOG_CFLOW;
	/* Combination / Stat  */
	COMBI_NewTable 	aCOMBI_NewTable;
	COMBI_Accum 	aCOMBI_Accum;
	COMBI_NewTest 	aCOMBI_NewTest;
	STAT_Accum 	aSTAT_Accum;
	STAT_NewTest 	aSTAT_NewTest;
} LOG_CALL_DATA;

STG_LOG_TEXT_PARSING typedef struct _... {
# BASIC_COMMON_LOG_KUN #
	STIME time;	 %Time%  /**< ּ2 */ 	
	MTIME		utime;  %MTime%	 	/**< micro  Ÿ ð */

	IP4 		uiIP;					%IPAddr%				/**< IP address */
	U8			ucTMSI[DEF_SIZE_TMSI];	%TMSI%					/**< TMSI */
	U8			ucIMSI[DEF_SIZE_IMSI];	%IMSI%					/**< IMSI */

	U32		uiBase; 			%BASE%  /**< BASEID */ 	#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>BASE_ID:{DIGIT}#
	U8		uiNID[EX_MAX_NID]; 	 /**< NID */  %NID%		#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>KUN_NID:{VALUE}#  
	U32		uiSID; 				/**< SID */  #PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>KUN_SID:{DIGIT}#

	U32		Test1;
} LOG_KUN;

STG_LOG_TEXT_PARSING typedef struct _... {
# BASIC_COMMON_LOG_ME #
	STIME time;	 %METime%  /**< ּ3 */ 
	MTIME		utime;  %MTime%	 	/**< micro  Ÿ ð */

	IP4 		uiIP;					%IPAddr%				/**< IP address */
	U8			ucTMSI[DEF_SIZE_TMSI];	%TMSI%					/**< TMSI */
	U8			ucIMSI[DEF_SIZE_IMSI];	%IMSI%					/**< IMSI */

	U32		uiBase; 			%BASE%  /**< BASEID */ 	#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>BASE_ID:{DIGIT}#
	U8		uiNID[EX_MAX_NID]; 	 %NID%  /**< NID */ 	#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>NID:{VALUE}#  
	U32		uiSID; 				/**< SID */  #PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>ME_SID:{DIGIT}#

	U32		Test2;
} LOG_ME;

FIRST / LAST ߰ : ϴ 迡 ̰͵ ߰ - combination ߰Ǿ Ѵ.  
׳ keyword Fix ų ̴. Ưڿ Ϲ  ȥ Keyword
#FIRST#  / #LAST#
 default  #FIRST#
< combination common  ߰Ǿ Ѵ. > 


[[2006.07.28]]   (  ... ) 
STG_COMMON  ó Ͽ Ѵ. 
STG_COMMON Ϻ Ϸ :   ʿҶ  ߰ϴ  Ѵ.  
SErvice (Lex libraryα Ϸ)
COMMON -> CALL
PAGE -> Tokening  (ȭ)


[[2006.08.01]]   (  ... ) 
* PAGE -> Tokening  (ȭ)
	href ߿
	img ؼ óִ  Ȯ
	ش : BODY.stc ؼ  ߴµ Ǵ ߿  캸  ؾ   δ.  
* shared memory ¥Ѵ. () - new interface
	- 踦 Ѵ. (NewInterface)

* Memg Node  ( ð Ͽ  ۾ Ҽ ִ)
+-------+-----+------+------------+
|Magic# | A/F | Time | Alloc_Name |
+-------+-----+------+------------+
|      Buffer                     |
+---------------------------------+

* NewInterface Node 
+-------+-----+------+------------+
|Magic# | A/F | Time | Alloc_Name |
+-------+-----+------+------------+
| List(cont)      ----------------------->   NewInterface Node  ( MSG NODE SIZE )
+---------------------------------+
| List(next)   -----------+       | 
+-------------------------|-------+
| From | To | Common      |       |
+-------------------------|-------+
|    TLVs                 |       |
+-------------------------|-------+
                          |       
                          V       
+-------+-----+------+------------+
|Magic# | A/F | Time | Alloc_Name |
+-------+-----+------+------------+
| List(cont)      ----------------------->   NewInterface Node ( MSG NODE SIZE )
+---------------------------------+
| List(next)   ڽ               | 
+---------------------------------+
| From | To | Common              |
+---------------------------------+
|    TLVs                         |
+---------------------------------+
                                  
NODE :INIT

NewInterface primitives : put (link) 
	foreach  
	, freeall , unlink :  ѹ  ٽ 
	put_cont , put_next

-- MSG Qκ ޾
offset = msg_get ;
headnodeptr = OFFSET_TO_PTR(offset);
foreach(p, headnodeptr.next){
	foreach(c , p.cont){
	}
}

-- Ͽ MSG Q   
headnode listhead
ptr = alloc_node;
	ptr->..   set
node 
	cont : put(headnode.cont , OFFSET(ptr));
	next : put(headnode.next , OFFSET(ptr));
 Ϸ
	send_to_msgQ(TO , OFFSET(ptr));

Circular Queue MsgQueue ġ. 
-   :  ˾Ƽ ش. Process input Ѱ .
-   : Queue   data鿡 ؼ   ų ־ Ѵ.
(ֱ 30 ̻ ޸𸮴 Free ٲִ κе  Ҽ ִ. ̷   ϰ ϱ ؼ Freelist array  Ҽ ִ.)

[[2006.08.02]]  ٰ   
* SHM 
	memg   :  
		ð ߰ 
		̰  ʰ ֳ...  Ϸ : OFFSET/PTR  
		 - semaphone ߰ ,  status ߰
	listo , memg , msgq     óϴ structure TLV óϴ structure ׿  Լ/MACRO Ͽ Ѵ.

* LOG ȸǸ Ͽ fix ؾ   δ. Ư , Error traceҼ ִ    ̴. 


** STG_COMMON    ؼ **
<TAG_DEFINE_START:RespCode>
#define	RespCode_A_Type  1 /* TTT */
#define	RespCode_B_Type  2
#define	RespCode_C_Type  3
<TAG_DEFINE_END:RespCode>

#define TEST_TEST		333
STG_COMMON typedef struct _stg_call {
		<TAG_COMMON_MEMBER:LOG_KUN>%KUN_CTime%  /**< ּ2 */ 	
		<TAG_COMMON_MEMBER:LOG_ME>%ME_CMETime%  /**< ּ3 */ 
	STIME Ctime;	 %CCreateTime% /**<  ⺻ ּ  : DEFAULT  ̰ ϰ  : ʱ Ÿ ð */ 	#FIRST#
	MTIME		Cutime;  %CMTime%	 	/**< micro  Ÿ ð */	#FIRST#

<TAG_KEY>
	IP4 		CuiIP;					%CIPAddr%				/**< IP address */
	U8			CucTMSI[DEF_SIZE_TMSI];	%CTMSI%					/**< TMSI */		#FIRST#		/* TT */
	U8			CucIMSI[DEF_SIZE_IMSI];	%CIMSI%					/**< IMSI */	/* KR */
</TAG_KEY>

		<TAG_COMMON_MEMBER:LOG_KUN> /**< NID */  %KUN_CNID%		#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>KUN_NID:{VALUE}#  
	U32		CuiBase; 			%CBASE%  /**< BASEID */ 	#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>BASE_ID:{DIGIT}# #LAST#
	U8		CuiNID[EX_MAX_NID]; 	 %CNID%  /**< NID */ 	#PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>NID:{VALUE}#  

		<TAG_COMMON_MEMBER:LOG_ME>  /**< ME_SID */  #PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>ME_SID:{DIGIT}#
		<TAG_COMMON_MEMBER:LOG_KUN>  /**< KUN_SID */  #PARSING_RULE:^^:REQ_HDR:^^:<HTTP_PHONE_2G_PHONE_SYSTEM_PARAMETER>KUN_SID:{DIGIT}#
	U32		<TAG_DEFINE:RespCode>CuiSID; 	#LAST#			
} LOG_CALL;

STG_COMMON  ؼ Ѵ.   COMMON INFO Ÿ  ⿡   structure  , װͿ ־ִ  ٸ ִ. <TAG_COMMOM_MEMBER:    ٸ  ְ ȴ.
<TAG_DEFINE_START:̸>  ... END   define   Ʒ <TAG_dEFINE:̸>  ϸ ȴ.
<TAG_COMMON_MEMBER:LOG̸>  LOG̸ Ϳ  ڿ ִ  ְ Ǵ  
 LOG̸ٿ 	<STG_COMMON:LOG_CALL> ̶  Ǿ ̷ κ ϰ Ǵ ̴.


[[2006.08.03]]  
*   
MSG : cont , next  Ѱ ó  (ټ NODE 2 )
cont : data Ѱ NODE size  ߰ ҴǾ ͵ (ο buffer Ƽ óϴ  ) - ޸    ġ
next : header , body   Ѱ ٷ̷ ó Ҷ ( ٷ   sync ° óؾ Ҷ )

* newifo  (primitives)
node = * newifo_node_alloc(info);
	: NODE 1 Ҵ (𿡵 link   ) 

newifo_Write(MSGQ_ID,&node_head , &status);
	: MSGQ node  ( process node offset  ó)
	: ۽ô OFFSET()  
node_head = * newifo_make_msg(common_info[FROM|TO|COMMON] , buffer , size);
node_cont_head = * link_cont(node_cont_head, node);
node_next_head = * link_next(node_next_head, node);
node_head = * link(node_head,node);		// ڿ ߰   node = * link(node,node_head); տ ߰

node_head = * newifo_Read( MSGQ_ID, &status);
	; msg Q  Ѱ д´.
	:  node cont , next  Ѱ MSG ̴.
	: OFFSET ۵  pointer ٲپ return
for_each_start(init ; node_next = ; node_next = node_next->next)  : MACRO
	: node_next cont   ѹ  pointer returnǾ
for_each_end(init ; node_next = ; node_next = node_next->next)  : MACRO
	: õ node freeִ  
node_cont_head = * unlink_cont(node_cont_head, node);
node_next_head = * unlink_next(node_next_head, node);
node_head = * unlink(node_head, node);  // 1 node link鿡 
:: bypass־ ϴ ͵鿡  ó ߰(cont ġ  Ʊ.) 
::   FROM | TO | COMMON ڷḦ  bypass 


[[2006.08.04]]  
*    : Ƽ ߰ؼ мϴ κб 
Ƽ  download online Ѵٴ  ᱹ ME/KUN ⺻ ȴٴ .

* TCP HTTP     : Ƽ  ߰

*  MSG   :   


[[2006.08.14]]
* PAGE  Flow ó 
[STG ]
%NEW_MSG : STATE : which variable : value : NEXT STATE%  #Action#

ο MSG ް Ǹ 
+-------------+
|    STATE    |
|   #action#  |
+-------------+  --------------------------->  ,_____________,
                   Which variable == value     | NEXT STATE  |
                                               +_____________+

<TAG_FLOW_START:PAGE_FLOW>
%OTHERMSG : OK:(D)thisLOG->SrvL7code:(Y) MENU:TEXT_MENU%  #OK_action a  state#
%CONTINUE:TEXT_MENU:(L)thisPage->urllistinfo:(Y)thisLOG->url:TEXT_MENU%  #TEXT_MENU_action a state#
%CONTINUE:TEXT_MENU:(L)thisPage->urllistinfo:(N)thisLOG->url:NEXT_STATE%   #TEXT_MENU_action a state#
<TAG_FLOW_END:PAGE_FLOW>

(S) : String Compare
(D) : Digit Compare
(L) : String List Compare

(Y) : (L) ϴ  Listȿ Matching ɶ  or   Ҷ 
(N) : (L) Ǵ  Matching String 

this , p ~ ڿ ٴ ̸ typdef ̸ ״ ϴ  Ģ Ѵ.


  : 
OK_if(srvL7Code){
  switch(srvL7Code){
  case MENU: return TEXT_MENU;
  
}
OK_on(isSTART_CALL){
  isNEED_NEW=NO;
  page_state = OK;
  OK_action();
  if(isNEED_NEW==YES &&
     isSTART_CALL == NO)  return ;
  state_go(OK_if(svrL7Code),isSTART_CALL=NO);
} 

TEXT_MENU_if(thisurlListinfo , newurl){
  if(Does thisurlList include newurl == YES) return TEXT_MENU;
  else NEXT_STATE;
}
TEXT_MENU_on(isSTART_CALL){
  isNEED_NEW = YES
  page_state = TEXT_MENU
  page_cateroty = MENU
  TEXT_MENU_action(); a body_parsing&save
  if(isNEED_NEW==YES &&
     isSTART_CALL == NO)  return ;
  state_go(TEXT_MENU_if(),isSTART_CALL=NO);
}

state_go(state_num,isSTART_CALL){
  switch(state_num){
  case OK: OK_on(isSTART_CALL);
  case TEXT_MENU: TEXT_MENU_on(isSTART_CALL);
  
  }
}

main(){
  Read_NODE();
  state_go(page_state,isSTART_CALL=YES);
}



[[2006.08.14]]
ϴ dot ׸ ׸   ؾ  ̴. 

ITERATE ȿ IFEQUAL ߰   Ѱ lineθ ǵ.



̰ ִ  C++ get/set member function  ؼ̴. 
$save_typedef_name_(typedef_name){member} = membertype;
$save_typedef_member_(member){typedef_name} = membertype;
$save_typedef_member{member} = membertype; // ó  setϰ  ͵   ̾ Ѵ.

/** LOG_member_Get_func.c ȿ ǵǾ ȴ. 
⺻  ϴ ͵  Ǹ ص ʿ䰡   δ. ̰ OUTPUT   ǰ ϸ Makefile ־ compile ǰ ϴ    δ.  */

stc.upr  ⺻  ־ ϴ ͵ ؼ ϰ ϴ  ϴ.



[[2006.08.21]]
ῡ  ̾߱  κ:
v1.84 : LOG table  ̸ ٸ type̸ die    (߰ Ϸ)   v1.84

page state diagram test program  Ϸ (flow.stg,flow.stc)
structg.pl : v1.87 
flow.stc : v1.5
flow.stg : v1.8
LOG_member_Get_func.c : v1.2


precompile : STG_COMMON  alternative Ѱ    ذ (STG_BASIC )
aqua.stg : v1.3
structg_precompile1.pl : v1.5




[[2006.08.22]]
(Ϸ) 1. precomile ؾϴ ͵鿡  Ȯڴ .pstg  ϴ    δ. ̰ ϸ Ȯڰ .stg  ϸ   δ.
	pstg.pl 
	pstg file : test.stg -> test.pstg  , aqua.stg -> aqua.pstg
	Makefile flow , aqua , test   ߰
(Ϸ) 2. stg multi óҼ ְ  stg  쿡 ̰͵  óҼ ִ stgl  ؾ   δ. (Է file stgl  쿡 List ؼϿ óϵ structg.pl  ϸ   δ.) - precompileñ ߰ ϴ    δ.
    Ѱ ִ   ̶ ȴ. FileName .h   Ǵ ̰, stgȿ ִ FileName  ǰ  ̴.
    test.stg , flow.stg ִٰ ϸ __ FileName  , STC_FileName  ġ ,  
    *.stg  ͵ FileName.h -> $outputdir/FileName.stg .     ó Ѵ.
(Ϸ) 3. Ƽ action  IFEQUAL ó ϰ .
	action ó   ⿡  action ϰ Ͽ, δ vertex  action ϴ  ´ٰ  ȴ.
#{    ...    }#       multi-line ߰ 
4. PREA , CAPD binaryó ؾ   : BILLCOMM signature2 
5. ּ ޾ƾ Ѵ.
6. state ó action state ξ . (ݰ  edge θ ȵǰ, vertex ξ )




[[2006.08.23]] 
츮 ϱ ϴ binary ó   ϴ ΰ?
ϴ Fixed type RFCȿ Ǿ.    type    structure ˷ִ  .
 



